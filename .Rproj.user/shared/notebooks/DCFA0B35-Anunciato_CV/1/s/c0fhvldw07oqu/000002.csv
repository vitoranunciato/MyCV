"0","library(tidyverse)"
"0","library(waffle)"
"0","library(extrafont)"
"0","library(readxl)"
"0","library(ggthemes)"
"0",""
"0","data = read_excel(""data/abstract.xlsx"")"
"0",""
"0","data %>% "
"0","  count(data, main) -> data_df"
"0",""
"0","df = data %>% "
"0","  group_by(main) %>% "
"0","  count()"
"0","df = as.data.frame(df)    "
"0","df = df %>% "
"0","  rename(count = n) "
"0",""
"0","vals <- df$count"
"0","val_names <- sprintf(""%s (%s)"", df$main, scales::percent(round(df$count/sum(df$count), 2)))"
"0","names(vals) <- val_names"
"0",""
"0","ggplot(data_df, aes(fill = main, values = n)) +"
"0","  geom_waffle(color = ""white"", size = .25, n_rows = 2, flip = TRUE) +"
"0","  facet_wrap(~data, nrow = 1, strip.position = ""bottom"") +"
"0","  scale_x_discrete() +"
"0","  scale_y_discrete(limits = c(0, 2, 4, 6, 8, 10))+"
"0","  scale_fill_grey(start = 0.2, end = 0.9, labels = val_names)+"
"0","  coord_equal() +"
"0","  labs("
"0","    title = ""Posters and oral presentation in scientific meetings"","
"0","    subtitle = ""One square:one study"","
"0","    x = ""Year"","
"0","    y = ""Count"","
"0","    fill = ""Main topic of studies"","
"0","    caption = ""(%) in legends, represents the percentage of the theme relative to the total of publications."""
"0","  ) +"
"0","  theme_minimal(base_family = ""Roboto Condensed"") +"
"0","  theme(panel.grid = element_blank(), axis.ticks.y = element_line(), panel.margin.x=unit(0.01, ""lines""), panel.spacing.y=unit(0.1, ""lines"")) +"
"0","  guides(fill = guide_legend(reverse = TRUE))"
